/*
  This class has been generated by the Code Generator
*/

package com.worksitewsapppackage;

import com.cordys.cpc.bsf.busobject.BusObjectConfig;
import com.cordys.cpc.bsf.busobject.BusObjectIterator;
import com.cordys.cpc.bsf.busobject.QueryObject;
import com.cordys.cpc.bsf.busobject.DMLStatement;
import com.eibus.util.logger.CordysLogger;
import com.cordys.cpc.bsf.busobject.BusObject;
import java.util.*;
import com.cordys.cpc.bsf.busobject.BSF;


public class ADL_DataAfterCompare extends ADL_DataAfterCompareBase
{
public static CordysLogger BRELogger=CordysLogger.getCordysLogger(ADL_DataAfterCompare.class);
    public ADL_DataAfterCompare()
    {
        this((BusObjectConfig)null);
    }

    public ADL_DataAfterCompare(BusObjectConfig config)
    {
        super(config);
    }

    public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getUnProcessedLatestMasterAPPID(String OnlyNB, String Group_Num)
    {
		//querytext="select top 1 WCP.*,ADL.FILEID,ADL.DESCRIPTION from ADL_DataAfterCompare ADL join WKSOpsControlRep WCP on ADL.GROUPNUMBER=WCP.Group_Number where ADL.OTStatus='UnProcessed'  and ADL.DESCRIPTION='NEW/INDIVIDUAL' and ADL.GROUPNUMBER='Group_Num' order by WCP.Created_Date desc";
String Tab_Val="Table";
       String querytext="";
	   if(OnlyNB.equals("yes"))
	    querytext="select * from (select  top 1 wkc.Id,wkc.MasterappSFId,wkc.Group_Number,adl.GROUPNUMBER,adl.FILEID,adl.DESCRIPTION,adi.FileName as OriginalFile from ADL_InputFiles adi join ADL_DataAfterCompare adl on adi.FileID=adl.FILEID join WKSOpsControlRep wkc on adl.GROUPNUMBER=wkc.Group_Number where adi.Status='CCProcessed' and adl.OTStatus='UnProcessed' and adl.GroupNumber='"+Group_Num+"' order by wkc.Id desc) as all3TablesData";
		else
		querytext="select top 1 all3TablesData.Id,all3TablesData.MasterappSFId,all3TablesData.Group_Number,all3TablesData.GROUPNUMBER,all3TablesData.FILEID,all3TablesData.DESCRIPTION,all3TablesData.OriginalFile from (select  top 2 wkc.Id,wkc.MasterappSFId,wkc.Group_Number,adl.GROUPNUMBER,adl.FILEID,adl.DESCRIPTION,adi.FileName as OriginalFile from ADL_InputFiles adi join ADL_DataAfterCompare adl on adi.FileID=adl.FILEID join WKSOpsControlRep wkc on adl.GROUPNUMBER=wkc.Group_Number where adi.Status='CCProcessed' and adl.OTStatus='UnProcessed' and adl.GroupNumber='"+Group_Num+"' order by wkc.Id desc) as all3TablesData order by all3TablesData.Id asc";
	   
QueryObject query = new QueryObject(querytext);

query.addParameter("Group_Num", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, Group_Num);
query.setResultClass(ADL_DataAfterCompare.class);
return query.getObjects();

    }
	 public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getUnProcessedLatestMasterAPPID_New()
    {
       String querytext="select  top 1 wkc.*,adi.*,adl.* from ADL_InputFiles adi join ADL_DataAfterCompare adl on adi.FileID=adl.FILEID join WKSOpsControlRep wkc on adl.GROUPNUMBER=wkc.Group_Number where adi.Status='Processed' and adl.OTStatus='UnProcessed' order by wkc.Created_Date desc";
	   
QueryObject query = new QueryObject(querytext);
query.setResultClass(ADL_DataAfterCompare.class);
return query.getObjects();
    }
    public static int updateADLDataUsingGroupNumber(String group_num, String master_app_sf_id, java.util.Date enroll_end_date, String ot_status,java.util.Date File_Transmission_Date)
	{
		DMLStatement dml = null;
		String queryText="update ADL_DataAfterCompare set OTStatus='ToBeProcessed',MasterAppSFID='"+master_app_sf_id+"',EnrollmentEnddate='"+enroll_end_date+"',FileTransmissionDate='"+File_Transmission_Date+"' where GroupNumber ='"+group_num+"' and  OTStatus='"+ot_status+"'";
//BRELogger.error("ERROR_MESSAGE : "+queryText);		
dml = new DMLStatement(queryText);
//BRELogger.error("ERROR_MESSAGE : "+dml);	
		dml.execute();

		return (int)1;
	}
	 public static int updateADLStatusUsingGrpNumFileId(String group_num, String file_id, String ot_status)
	{
		DMLStatement dml = null;
		String queryText="update ADL_DataAfterCompare set OTStatus='"+ot_status+"' where GROUPNUMBER ='"+group_num+"' and FILEID in ("+file_id+")";
//BRELogger.error("ERROR_MESSAGE : "+queryText);		
dml = new DMLStatement(queryText);
//BRELogger.error("ERROR_MESSAGE : "+dml);	
		dml.execute();

		return (int)1;
	}
	 public static int updateADLDataUsingFileID(String file_id, String master_app_sf_id, String enroll_end_date, String ot_status, String grp_num,String status,String File_Transmission_Date)
    {
        DMLStatement dml = null;
		String queryText="update ADL_DataAfterCompare set OTStatus='"+status+"',MasterAppSFID='"+master_app_sf_id+"',EnrollmentEnddate='"+enroll_end_date+"',FileTransmissionDate='"+File_Transmission_Date+"' where FILEID in ("+file_id+") and OTStatus='"+ot_status+"' and GROUPNUMBER='"+grp_num+"'";
//BRELogger.error("ERROR_MESSAGE : "+queryText);		
dml = new DMLStatement(queryText);
//BRELogger.error("ERROR_MESSAGE : "+dml);	
		dml.execute();

		return (int)1;
    }
	
	  public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getADLGroupData(String group_number)
    {
        BusObjectIterator <ADL_DataAfterCompare> resp1 = null;
		//String querytext="select GROUPNUMBER,MAX(MASTERAPPSFID) as MasterAppSF_ID,AgentCode,PAYMODE,STATE from ADL_DataAfterCompare where GROUPNUMBER='"+group_number+"' and Status='ToBeProcessed' group by AgentCode,GROUPNUMBER,PAYMODE,STATE";
		
		/*
		String querytext="select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFD.WritingAgent,UFD.DeductionFrequency,UFD.State,UFD.ProductNumber from ADL_DataAfterCompare ADC join UF_DataValues UFD on ADC.SSN=UFD.EmployeeSSN and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+group_number+"' and ADC.OTStatus='Processed' group by UFD.AgentCode,ADC.GROUPNUMBER,UFD.PAYMODE,UFD.STATE,UFD.ProductNumber";

		QueryObject query = new QueryObject(querytext);
		//logger.error("Method: ADL*********"+querytext);
		query.addParameter("GROUPNUMBER", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, group_number);
		query.setResultClass(ADL_DataAfterCompare.class);
		resp1=query.getObjects();

		if(resp1 == null ) 
				{
		 querytext="select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFN.WritingAgent,UFN.DeductionFrequency,UFN.State,UFN.ProductNumber,UFN.EmployeeSSN,UFN.FileID from ADL_DataAfterCompare ADC join UFN_DataValues UFN on ADC.SSN=UFN.EmployeeSSN and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+group_number+"' and ADC.OTStatus='ToBeProcessed' group by UFN.AgentCode,ADC.GROUPNUMBER,UFN.PAYMODE,UFN.STATE,UFN.ProductNumber,UFN.FileID";


		//logger.error("Method: ADL*********"+querytext);
		query.addParameter("GROUPNUMBER", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, group_number);
		query.setResultClass(ADL_DataAfterCompare.class);
		resp1=query.getObjects();
				}
		return resp1;
			}
		*//* column encryption and decryption change */
		String querytext="select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFD.WritingAgent,UFD.DeductionFrequency,UFD.State,UFD.ProductNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on CONVERT(Int,ADC.SSN)=CONVERT(INT,UFD.EmployeeSSN) and ADC.FILEID=UFD.FileID and ADC.PRODUCTNUMBER=UFD.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and UFD.RecordType='1' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by UFD.WritingAgent,UFD.DeductionFrequency,ADC.GROUPNUMBER,UFD.STATE,UFD.ProductNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFN.WritingAgent,UFN.DeductionFrequency as DeductionFrequency,UFN.State,UFN.ProductNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on CONVERT(Int,ADC.SSN)=CONVERT(INT,UFN.EmployeeSSN) and ADC.FILEID=UFN.FileID and ADC.PRODUCTNUMBER=UFN.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and UFN.RecordType='1' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by UFN.WritingAgent,UFN.DeductionFrequency,ADC.GROUPNUMBER,UFN.STATE,UFN.ProductNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA53.WritingAgent, EA53.PayrollDeductionMode,EA53.ApplicationState, EA53.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA53 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA53.EmployeeSSN) and ADC.FILEID=EA53.FileID and ADC.PRODUCTNUMBER=EA53.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA53.WritingAgent, EA53.PayrollDeductionMode, ADC.GROUPNUMBER,EA53.ApplicationState,EA53.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA54.WritingAgent, EA54.PayrollDeductionMode,EA54.ApplicationState, EA54.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA54 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA54.EmployeeSSN) and ADC.FILEID=EA54.FileID and ADC.PRODUCTNUMBER=EA54.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA54.WritingAgent, EA54.PayrollDeductionMode, ADC.GROUPNUMBER,EA54.ApplicationState,EA54.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA55.WritingAgent, EA55.PayrollDeductionMode,EA55.ApplicationState, EA55.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA55 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA55.EmployeeSSN) and ADC.FILEID=EA55.FileID and ADC.PRODUCTNUMBER=EA55.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA55.WritingAgent, EA55.PayrollDeductionMode, ADC.GROUPNUMBER,EA55.ApplicationState,EA55.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA56.WritingAgent, EA56.PayrollDeductionMode,EA56.ApplicationState, EA56.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA56 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA56.EmployeeSSN) and ADC.FILEID=EA56.FileID and ADC.PRODUCTNUMBER=EA56.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA56.WritingAgent, EA56.PayrollDeductionMode, ADC.GROUPNUMBER,EA56.ApplicationState,EA56.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA52.WritingAgent, EA52.PayrollDeductionMode, EA52.ApplicationState, Ea52.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA52 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA52.EmployeeSSN) and ADC.FILEID=EA52.FileID and ADC.PRODUCTNUMBER=EA52.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA52.WritingAgent, EA52.PayrollDeductionMode, ADC.GROUPNUMBER,EA52.ApplicationState, Ea52.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA51.WritingAgent, EA51.PayrollDeductionMode, EA51.ApplicationState, Ea51.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA51 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA51.EmployeeSSN) and ADC.FILEID=EA51.FileID and ADC.PRODUCTNUMBER=EA51.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA51.WritingAgent, EA51.PayrollDeductionMode, ADC.GROUPNUMBER,EA51.ApplicationState, EA51.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA50.WritingAgent, EA50.PayrollDeductionMode, EA50.ApplicationState, EA50.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA50 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA50.EmployeeSSN) and ADC.FILEID=EA50.FileID and ADC.PRODUCTNUMBER=EA50.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA50.WritingAgent, EA50.PayrollDeductionMode, ADC.GROUPNUMBER,EA50.ApplicationState, EA50.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA42.WritingAgent, EA42.PayrollDeductionMode, EA42.ApplicationState, EA42.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA42 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA42.EmployeeSSN) and ADC.FILEID=EA42.FileID and ADC.PRODUCTNUMBER=EA42.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA42.WritingAgent, EA42.PayrollDeductionMode, ADC.GROUPNUMBER,EA42.ApplicationState, EA42.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA49.WritingAgent, EA49.PayrollDeductionMode, EA49.ApplicationState, EA49.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA49 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA49.EmployeeSSN) and ADC.FILEID=EA49.FileID and ADC.PRODUCTNUMBER=EA49.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA49.WritingAgent, EA49.PayrollDeductionMode, ADC.GROUPNUMBER,EA49.ApplicationState, EA49.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA30.WritingAgent, EA30.PayrollDeductionMode, EA30.ApplicationState, EA30.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA30 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA30.EmployeeSSN) and ADC.FILEID=EA30.FileID and ADC.PRODUCTNUMBER=EA30.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA30.WritingAgent, EA30.PayrollDeductionMode, ADC.GROUPNUMBER,EA30.ApplicationState, EA30.productNumber";

		/* column encryption and decryption change */
	/*	String querytext="select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFD.WritingAgent,UFD.DeductionFrequency,UFD.State,UFD.ProductNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(UFD.EmployeeSSN)) and ADC.FILEID=UFD.FileID and ADC.PRODUCTNUMBER=UFD.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and UFD.RecordType='1' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by UFD.WritingAgent,UFD.DeductionFrequency,ADC.GROUPNUMBER,UFD.STATE,UFD.ProductNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFN.WritingAgent,UFN.DeductionFrequency as DeductionFrequency,UFN.State,UFN.ProductNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(UFN.EmployeeSSN)) and ADC.FILEID=UFN.FileID and ADC.PRODUCTNUMBER=UFN.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and UFN.RecordType='1' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by UFN.WritingAgent,UFN.DeductionFrequency,ADC.GROUPNUMBER,UFN.STATE,UFN.ProductNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA53.WritingAgent, EA53.PayrollDeductionMode,EA53.ApplicationState, EA53.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA53 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA53.EmployeeSSN)) and ADC.FILEID=EA53.FileID and ADC.PRODUCTNUMBER=EA53.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA53.WritingAgent, EA53.PayrollDeductionMode, ADC.GROUPNUMBER,EA53.ApplicationState,EA53.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA54.WritingAgent, EA54.PayrollDeductionMode,EA54.ApplicationState, EA54.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA54 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA54.EmployeeSSN)) and ADC.FILEID=EA54.FileID and ADC.PRODUCTNUMBER=EA54.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA54.WritingAgent, EA54.PayrollDeductionMode, ADC.GROUPNUMBER,EA54.ApplicationState,EA54.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA55.WritingAgent, EA55.PayrollDeductionMode,EA55.ApplicationState, EA55.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA55 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA55.EmployeeSSN)) and ADC.FILEID=EA55.FileID and ADC.PRODUCTNUMBER=EA55.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA55.WritingAgent, EA55.PayrollDeductionMode, ADC.GROUPNUMBER,EA55.ApplicationState,EA55.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA56.WritingAgent, EA56.PayrollDeductionMode,EA56.ApplicationState, EA56.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA56 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA56.EmployeeSSN)) and ADC.FILEID=EA56.FileID and ADC.PRODUCTNUMBER=EA56.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA56.WritingAgent, EA56.PayrollDeductionMode, ADC.GROUPNUMBER,EA56.ApplicationState,EA56.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA52.WritingAgent, EA52.PayrollDeductionMode, EA52.ApplicationState, Ea52.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA52 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA52.EmployeeSSN)) and ADC.FILEID=EA52.FileID and ADC.PRODUCTNUMBER=EA52.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA52.WritingAgent, EA52.PayrollDeductionMode, ADC.GROUPNUMBER,EA52.ApplicationState, Ea52.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA51.WritingAgent, EA51.PayrollDeductionMode, EA51.ApplicationState, Ea51.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA51 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA51.EmployeeSSN)) and ADC.FILEID=EA51.FileID and ADC.PRODUCTNUMBER=EA51.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA51.WritingAgent, EA51.PayrollDeductionMode, ADC.GROUPNUMBER,EA51.ApplicationState, EA51.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA50.WritingAgent, EA50.PayrollDeductionMode, EA50.ApplicationState, EA50.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA50 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA50.EmployeeSSN)) and ADC.FILEID=EA50.FileID and ADC.PRODUCTNUMBER=EA50.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA50.WritingAgent, EA50.PayrollDeductionMode, ADC.GROUPNUMBER,EA50.ApplicationState, EA50.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA42.WritingAgent, EA42.PayrollDeductionMode, EA42.ApplicationState, EA42.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA42 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA42.EmployeeSSN)) and ADC.FILEID=EA42.FileID and ADC.PRODUCTNUMBER=EA42.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA42.WritingAgent, EA42.PayrollDeductionMode, ADC.GROUPNUMBER,EA42.ApplicationState, EA42.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA49.WritingAgent, EA49.PayrollDeductionMode, EA49.ApplicationState, EA49.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA49 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA49.EmployeeSSN)) and ADC.FILEID=EA49.FileID and ADC.PRODUCTNUMBER=EA49.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA49.WritingAgent, EA49.PayrollDeductionMode, ADC.GROUPNUMBER,EA49.ApplicationState, EA49.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA30.WritingAgent, EA30.PayrollDeductionMode, EA30.ApplicationState, EA30.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA30 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA30.EmployeeSSN)) and ADC.FILEID=EA30.FileID and ADC.PRODUCTNUMBER=EA30.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA30.WritingAgent, EA30.PayrollDeductionMode, ADC.GROUPNUMBER,EA30.ApplicationState, EA30.productNumber"; */
		QueryObject query = new QueryObject(querytext);
		//BRELogger.error("ERROR_MESSAGE : "+querytext);	
		query.addParameter("GROUPNUMBER", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, group_number);
		query.setResultClass(ADL_DataAfterCompare.class);
		return query.getObjects();
}
public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getFPProductCountByGroupNumber(String GROUPNUMBER)
    {
       
String querytext="select DRP.Description, count(UFD.productnumber) as Count from UFN_DataValues UFD join ADL_DataAfterCompare ADL on  ADL.PRODUCTNUMBER=UFD.ProductNumber and ufd.EmployeeSSN= adl.ssn and ufd.FileID=adl.FILEID and DESCRIPTION = 'NEW/INDIVIDUAL' and ufd.RecordType='1' join (  select distinct Description, Value from WKSDropDownTable where Identifier = 'WorksiteProducts') DRP on DRP.value = ufd.ProductNumber where ADL.FILEID in ("+GROUPNUMBER+") group by DRP.Description ,ADL.FILEID";
/* column encryption and decryption change */
/*
String querytext="select DRP.Description, count(UFD.productnumber) as Count from UFN_DataValues UFD join ADL_DataAfterCompare ADL on  ADL.PRODUCTNUMBER=UFD.ProductNumber and dbo.fn_fpdecryptdata(ufd.EmployeeSSN)= dbo.fn_fpdecryptdata(adl.ssn) and ufd.FileID=adl.FILEID and DESCRIPTION = 'NEW/INDIVIDUAL' and ufd.RecordType='1' join (  select distinct Description, Value from WKSDropDownTable where Identifier = 'WorksiteProducts') DRP on DRP.value = ufd.ProductNumber where ADL.FILEID in ("+GROUPNUMBER+") group by DRP.Description ,ADL.FILEID";
*/
QueryObject query = new QueryObject(querytext);
query.addParameter("FILEID", "ADL_DataAfterCompare.FILEID", QueryObject.PARAM_STRING, GROUPNUMBER);
query.setResultClass(ADL_DataAfterCompare.class);
return query.getObjects();
}

/* column encryption and decryption change */
/*
public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getCaseRecordsFromADLAfterComp(String file_id, String description)
    {
		String querytext="";
		if (description.contains("CHANG"))
		querytext="Select distinct ADC.GROUPNUMBER, UFD.WritingAgent, UFD.DeductionFrequency, UFD.State, UFD.ProductNumber, dbo.fn_fpDecryptData(ADC.SSN)SSN, UFD.RecordType,"
				+"ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on ADC.PRODUCTNUMBER=UFD.ProductNumber and " 
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(UFD.EmployeeSSN)) and ADC.FILEID=UFD.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and UFD.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER, UFN.WritingAgent, UFN.DeductionFrequency, UFN.State, UFN.ProductNumber, "
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, UFN.RecordType,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on "
				+"ADC.PRODUCTNUMBER=UFN.ProductNumber and Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(UFN.EmployeeSSN)) and "
				+"ADC.FILEID=UFN.FileID where ADC.FILEID in ("+file_id+")  and ADC.OTStatus='Processed'  and "
				+"UFN.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN), '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA on   ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"'  "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA006DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.SignatureState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA011DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA012DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA020DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA021DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA040DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA045DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN), '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA047DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN), '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA048DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN), '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN), '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'"
                +"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN), '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN), '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"dbo.fn_fpDecryptData(ADC.SSN), '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'";	

		
		else if(description.equals("NEW/INDIVIDUAL") || description.equals("TERMINATED") || description.equals("REINST") )
			querytext="Select distinct ADC.GROUPNUMBER, UFD.WritingAgent, UFD.DeductionFrequency, UFD.State, UFD.ProductNumber, dbo.fn_fpDecryptData(ADC.SSN)SSN, UFD.RecordType,"
					+"ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on ADC.PRODUCTNUMBER=UFD.ProductNumber and " 
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(UFD.EmployeeSSN)) and ADC.FILEID=UFD.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and UFD.RecordType='1' and ADC.DESCRIPTION = '"+description+"'"
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER, UFN.WritingAgent, UFN.DeductionFrequency, UFN.State, UFN.ProductNumber, "
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, UFN.RecordType,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on "
					+"ADC.PRODUCTNUMBER=UFN.ProductNumber and Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(UFN.EmployeeSSN)) and "
					+"ADC.FILEID=UFN.FileID where ADC.FILEID in ("+file_id+")  and ADC.OTStatus='Processed'  and "
					+"UFN.RecordType='1' and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA on   ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'  "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA006DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.SignatureState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA011DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA012DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA020DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA021DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA040DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA045DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA047DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA048DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'"
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'"
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'"
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'"
					+"Union All "
					+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
					+"dbo.fn_fpDecryptData(ADC.SSN)SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
					+"Convert(INT,dbo.fn_fpDecryptData(ADC.SSN))=Convert(INT,dbo.fn_fpDecryptData(EA.EmployeeSSN)) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
					+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'";
		 

QueryObject query = new QueryObject(querytext);
//BRELogger.error("ERROR_MESSAGE : "+querytext);	
query.addParameter("file_id", "ADL_DataAfterCompare.FILEID", QueryObject.PARAM_STRING, file_id);
query.addParameter("description", "ADL_DataAfterCompare.DESCRIPTION", QueryObject.PARAM_STRING, description);
query.setResultClass(ADL_DataAfterCompare.class);
return query.getObjects();
    }
	*/

public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getCaseRecordsFromADLAfterComp(String file_id, String description)
    {
		String querytext="";
		if (description.contains("CHANG"))
		querytext="Select distinct ADC.GROUPNUMBER, UFD.WritingAgent, UFD.DeductionFrequency, UFD.State, UFD.ProductNumber, ADC.SSN, UFD.RecordType,"
				+"ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on ADC.PRODUCTNUMBER=UFD.ProductNumber and " 
				+"Convert(INT,ADC.SSN)=Convert(INT,UFD.EmployeeSSN) and ADC.FILEID=UFD.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and UFD.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER, UFN.WritingAgent, UFN.DeductionFrequency, UFN.State, UFN.ProductNumber, "
				+"ADC.SSN, UFN.RecordType,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on "
				+"ADC.PRODUCTNUMBER=UFN.ProductNumber and Convert(INT,ADC.SSN)=Convert(INT,UFN.EmployeeSSN) and "
				+"ADC.FILEID=UFN.FileID where ADC.FILEID in ("+file_id+")  and ADC.OTStatus='Processed'  and "
				+"UFN.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA on   ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"'  "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA006DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.SignatureState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA011DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA012DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA020DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA021DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA040DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA045DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA047DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA048DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'"
                +"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION like '"+description+"%'";	

		
		else if(description.equals("NEW/INDIVIDUAL") || description.equals("TERMINATED") || description.equals("REINST") )
        querytext="Select distinct ADC.GROUPNUMBER, UFD.WritingAgent, UFD.DeductionFrequency, UFD.State, UFD.ProductNumber, ADC.SSN, UFD.RecordType,"
				+"ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on ADC.PRODUCTNUMBER=UFD.ProductNumber and " 
				+"Convert(INT,ADC.SSN)=Convert(INT,UFD.EmployeeSSN) and ADC.FILEID=UFD.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and UFD.RecordType='1' and ADC.DESCRIPTION = '"+description+"'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER, UFN.WritingAgent, UFN.DeductionFrequency, UFN.State, UFN.ProductNumber, "
				+"ADC.SSN, UFN.RecordType,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on "
				+"ADC.PRODUCTNUMBER=UFN.ProductNumber and Convert(INT,ADC.SSN)=Convert(INT,UFN.EmployeeSSN) and "
				+"ADC.FILEID=UFN.FileID where ADC.FILEID in ("+file_id+")  and ADC.OTStatus='Processed'  and "
				+"UFN.RecordType='1' and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA on   ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'  "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA006DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.SignatureState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA011DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA012DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA020DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA021DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA040DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA045DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA047DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA048DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"' "
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'"
				+"Union All "
				+"Select distinct ADC.GROUPNUMBER,EA.WritingAgent,EA.payrolldeductionmode as DeductionFrequency,EA.applicationState as state,EA.ProductNumber,"
				+"ADC.SSN, '1' as recordtype,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA on ADC.PRODUCTNUMBER=EA.ProductNumber and "
				+"Convert(INT,ADC.SSN)=Convert(INT,EA.EmployeeSSN) and ADC.FILEID=EA.FileID where ADC.FILEID in ("+file_id+")  and "
				+"ADC.OTStatus='Processed'  and ADC.DESCRIPTION = '"+description+"'";


QueryObject query = new QueryObject(querytext);
//BRELogger.error("ERROR_MESSAGE : "+querytext);	
query.addParameter("file_id", "ADL_DataAfterCompare.FILEID", QueryObject.PARAM_STRING, file_id);
query.addParameter("description", "ADL_DataAfterCompare.DESCRIPTION", QueryObject.PARAM_STRING, description);
query.setResultClass(ADL_DataAfterCompare.class);
return query.getObjects();
    }
	public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getADLDataUponStatus(String status, String business_type, String process)
    {
        String querytext="Select distinct adc.GROUPNUMBER,adc.FILEID from ADL_DataAfterCompare adc where adc.OTStatus='"+status+"'";
		if(process.equalsIgnoreCase("Mixed"))
			querytext="Select distinct adc.GROUPNUMBER,adc.FILEID,adi.FileType from ADL_DataAfterCompare adc join ADL_InputFiles adi on adi.FileID=adc.FILEID where adc.OTStatus='"+status+"'";
		if(process.equalsIgnoreCase("PureNB"))
			querytext="Select distinct GROUPNUMBER,adi.FileType from ADL_DataAfterCompare adc join ADL_InputFiles adi on adi.FileID=adc.FILEID where adc.OTStatus='"+status+"'";
		 
		if(business_type != null && !business_type.trim().isEmpty() && !business_type.equalsIgnoreCase("PARAMETER"))
			querytext+=" and adc.Description='"+business_type+"'";

		QueryObject query = new QueryObject(querytext);
		query.addParameter("status", "ADL_DataAfterCompare.OTStatus", QueryObject.PARAM_STRING, status);
		query.addParameter("business_type", "ADL_DataAfterCompare.Description", QueryObject.PARAM_STRING, business_type);
		query.setResultClass(ADL_DataAfterCompare.class);
		return query.getObjects();
    }
	public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getNonNBADLDataUsingGroupNumber(String file_id)
    {
        String querytext="Select top 1 FILEID,GROUPNUMBER,MasterAppSFID from ADL_DataAfterCompare where (Description in ('TERMINATED') or DESCRIPTION like 'CHANG%' or Description in ('REINST')) and FILEID in ("+file_id+")";

QueryObject query = new QueryObject(querytext);
query.addParameter("file_id", "ADL_DataAfterCompare.FILEID", QueryObject.PARAM_STRING, file_id);
query.setResultClass(ADL_DataAfterCompare.class);
return query.getObjects();
    }
	public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getDistinctBusTypeByFileID(String file_id)
    {
         String querytext="select distinct DESCRIPTION from ADL_DataAfterCompare where FILEID in ("+file_id+") and DESCRIPTION in ('NEW/INDIVIDUAL','TERMINATED') union select top 1 description from ADL_DataAfterCompare where DESCRIPTION like 'CHANG%' and FILEID in ("+file_id+")";

QueryObject query = new QueryObject(querytext);
query.addParameter("file_id", "ADL_DataAfterCompare.FILEID", QueryObject.PARAM_STRING, file_id);
query.setResultClass(ADL_DataAfterCompare.class);
return query.getObjects();
    }
	public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getDistinctBusTypeByFileIDGrpNum(String file_id, String grp_num)
    {
         String querytext="select distinct DESCRIPTION from ADL_DataAfterCompare where FILEID in ("+file_id+") and GROUPNUMBER='"+grp_num+"' and DESCRIPTION in ('NEW/INDIVIDUAL','TERMINATED','REINST') union select top 1 description from ADL_DataAfterCompare where DESCRIPTION like 'CHANG%' and FILEID in ("+file_id+") and GROUPNUMBER='"+grp_num+"' ";

QueryObject query = new QueryObject(querytext);
query.addParameter("file_id", "ADL_DataAfterCompare.FILEID", QueryObject.PARAM_STRING, file_id);
query.addParameter("grp_num", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, grp_num);
query.setResultClass(ADL_DataAfterCompare.class);
return query.getObjects();
    }
	
    public static String convertCommaSeperatedValues(String file_id) {
        String S1 = new String(file_id);
       /* System.out.println("Original String is ': " + S1);
        System.out.println("String after replacing 'fox' with 'dog': '" + S1.replace(",", "','")+"'");
        System.out.println("String after replacing all 't' with 'a': " + S1.replace('t', 'a'));
*/
String val= "'"+ S1.replace(",", "','")+"'";
return val;
    }

	 public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getDistinctFileIDUsingGrpNum(String grp_num, String description, String status,String FileType)
    {
        String querytext="DECLARE @combinedString VARCHAR(MAX) SELECT @combinedString =  COALESCE(@combinedString + ', ', '') + convert(varchar(100), adc.FILEID) FROM ADL_DataAfterCompare adc join ADL_InputFiles adi on adi.FileID=adc.FILEID WHERE adc.GROUPNUMBER = '"+grp_num+"' and adc.DESCRIPTION='"+description+"' and adc.OTStatus='"+status+"' and adi.FileType='"+FileType+"' group by adc.FILEID SELECT @combinedString as fileid";

		QueryObject query = new QueryObject(querytext);
		query.addParameter("grp_num", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, grp_num);
		query.addParameter("description", "ADL_DataAfterCompare.DESCRIPTION", QueryObject.PARAM_STRING, description);
		query.addParameter("status", "ADL_DataAfterCompare.OTStatus", QueryObject.PARAM_STRING, status);
		query.setResultClass(ADL_DataAfterCompare.class);
		return query.getObjects();
    }
	   public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getFPTaskLevelCount(String grp_num, String agent_code, String pay_mode, String location, String product, String status, String description,String FileId)
    {
		String querytext="";
		if(description.equals("NEW/INDIVIDUAL") || description.equals("TERMINATED") || description.equals("REINST") || description.equals("REINSTATEMENT"))
		querytext="select ADC.GROUPNUMBER,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on  ADC.PRODUCTNUMBER=UFD.ProductNumber and  ADC.SSN=UFD.EmployeeSSN and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFD.WritingAgent='"+agent_code+"' and UFD.DeductionFrequency='"+pay_mode+"' and UFD.State='"+location+"' and UFD.ProductNumber='"+product+"' and UFD.RecordType='1' and ADC.DESCRIPTION = '"+description+"' and UFD.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on  ADC.PRODUCTNUMBER=UFN.ProductNumber and ADC.SSN=UFN.EmployeeSSN and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFN.WritingAgent='"+agent_code+"' and UFN.DeductionFrequency='"+pay_mode+"' and UFN.State='"+location+"' and UFN.ProductNumber='"+product+"' and UFN.RecordType='1'  and ADC.DESCRIPTION = '"+description+"' and UFN.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA53 on  ADC.PRODUCTNUMBER=EA53.ProductNumber and ADC.SSN=EA53.EmployeeSSN and ADC.FILEID=EA53.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA53.WritingAgent='"+agent_code+"' and EA53.PayrollDeductionMode='"+pay_mode+"' and EA53.ApplicationState='"+location+"' and EA53.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA53.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA54 on  ADC.PRODUCTNUMBER=EA54.ProductNumber and ADC.SSN=EA54.EmployeeSSN and ADC.FILEID=EA54.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA54.WritingAgent='"+agent_code+"' and EA54.PayrollDeductionMode='"+pay_mode+"' and EA54.ApplicationState='"+location+"' and EA54.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA54.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA55 on  ADC.PRODUCTNUMBER=EA55.ProductNumber and ADC.SSN=EA55.EmployeeSSN and ADC.FILEID=EA55.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA55.WritingAgent='"+agent_code+"' and EA55.PayrollDeductionMode='"+pay_mode+"' and EA55.ApplicationState='"+location+"' and EA55.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA55.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA56 on  ADC.PRODUCTNUMBER=EA56.ProductNumber and ADC.SSN=EA56.EmployeeSSN and ADC.FILEID=EA56.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA56.WritingAgent='"+agent_code+"' and EA56.PayrollDeductionMode='"+pay_mode+"' and EA56.ApplicationState='"+location+"' and EA56.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA56.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA52 on  ADC.PRODUCTNUMBER=EA52.ProductNumber and ADC.SSN=EA52.EmployeeSSN and ADC.FILEID=EA52.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA52.WritingAgent='"+agent_code+"' and EA52.PayrollDeductionMode='"+pay_mode+"' and EA52.ApplicationState='"+location+"' and EA52.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA52.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA51 on  ADC.PRODUCTNUMBER=EA51.ProductNumber and ADC.SSN=EA51.EmployeeSSN and ADC.FILEID=EA51.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA51.WritingAgent='"+agent_code+"' and EA51.PayrollDeductionMode='"+pay_mode+"' and EA51.ApplicationState='"+location+"' and EA51.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA51.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA50 on  ADC.PRODUCTNUMBER=EA50.ProductNumber and ADC.SSN=EA50.EmployeeSSN and ADC.FILEID=EA50.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA50.WritingAgent='"+agent_code+"' and EA50.PayrollDeductionMode='"+pay_mode+"' and EA50.ApplicationState='"+location+"' and EA50.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA50.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA42 on  ADC.PRODUCTNUMBER=EA42.ProductNumber and ADC.SSN=EA42.EmployeeSSN and ADC.FILEID=EA42.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA42.WritingAgent='"+agent_code+"' and EA42.PayrollDeductionMode='"+pay_mode+"' and EA42.ApplicationState='"+location+"' and EA42.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA42.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA49 on  ADC.PRODUCTNUMBER=EA49.ProductNumber and ADC.SSN=EA49.EmployeeSSN and ADC.FILEID=EA49.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA49.WritingAgent='"+agent_code+"' and EA49.PayrollDeductionMode='"+pay_mode+"' and EA49.ApplicationState='"+location+"' and EA49.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA49.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA30 on  ADC.PRODUCTNUMBER=EA30.ProductNumber and ADC.SSN=EA30.EmployeeSSN and ADC.FILEID=EA30.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA30.WritingAgent='"+agent_code+"' and EA30.PayrollDeductionMode='"+pay_mode+"' and EA30.ApplicationState='"+location+"' and EA30.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA30.FileID in("+FileId+")"; 
/* column encryption and decryption change */
/*
		querytext="select ADC.GROUPNUMBER,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on  ADC.PRODUCTNUMBER=UFD.ProductNumber and  dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(UFD.EmployeeSSN) and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFD.WritingAgent='"+agent_code+"' and UFD.DeductionFrequency='"+pay_mode+"' and UFD.State='"+location+"' and UFD.ProductNumber='"+product+"' and UFD.RecordType='1' and ADC.DESCRIPTION = '"+description+"' and UFD.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on  ADC.PRODUCTNUMBER=UFN.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(UFN.EmployeeSSN) and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFN.WritingAgent='"+agent_code+"' and UFN.DeductionFrequency='"+pay_mode+"' and UFN.State='"+location+"' and UFN.ProductNumber='"+product+"' and UFN.RecordType='1'  and ADC.DESCRIPTION = '"+description+"' and UFN.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA53 on  ADC.PRODUCTNUMBER=EA53.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA53.EmployeeSSN) and ADC.FILEID=EA53.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA53.WritingAgent='"+agent_code+"' and EA53.PayrollDeductionMode='"+pay_mode+"' and EA53.ApplicationState='"+location+"' and EA53.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA53.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA54 on  ADC.PRODUCTNUMBER=EA54.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA54.EmployeeSSN) and ADC.FILEID=EA54.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA54.WritingAgent='"+agent_code+"' and EA54.PayrollDeductionMode='"+pay_mode+"' and EA54.ApplicationState='"+location+"' and EA54.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA54.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA55 on  ADC.PRODUCTNUMBER=EA55.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA55.EmployeeSSN) and ADC.FILEID=EA55.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA55.WritingAgent='"+agent_code+"' and EA55.PayrollDeductionMode='"+pay_mode+"' and EA55.ApplicationState='"+location+"' and EA55.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA55.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA56 on  ADC.PRODUCTNUMBER=EA56.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA56.EmployeeSSN) and ADC.FILEID=EA56.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA56.WritingAgent='"+agent_code+"' and EA56.PayrollDeductionMode='"+pay_mode+"' and EA56.ApplicationState='"+location+"' and EA56.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA56.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA52 on  ADC.PRODUCTNUMBER=EA52.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA52.EmployeeSSN) and ADC.FILEID=EA52.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA52.WritingAgent='"+agent_code+"' and EA52.PayrollDeductionMode='"+pay_mode+"' and EA52.ApplicationState='"+location+"' and EA52.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA52.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA51 on  ADC.PRODUCTNUMBER=EA51.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA51.EmployeeSSN) and ADC.FILEID=EA51.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA51.WritingAgent='"+agent_code+"' and EA51.PayrollDeductionMode='"+pay_mode+"' and EA51.ApplicationState='"+location+"' and EA51.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA51.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA50 on  ADC.PRODUCTNUMBER=EA50.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA50.EmployeeSSN) and ADC.FILEID=EA50.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA50.WritingAgent='"+agent_code+"' and EA50.PayrollDeductionMode='"+pay_mode+"' and EA50.ApplicationState='"+location+"' and EA50.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA50.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA42 on  ADC.PRODUCTNUMBER=EA42.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA42.EmployeeSSN) and ADC.FILEID=EA42.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA42.WritingAgent='"+agent_code+"' and EA42.PayrollDeductionMode='"+pay_mode+"' and EA42.ApplicationState='"+location+"' and EA42.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA42.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA49 on  ADC.PRODUCTNUMBER=EA49.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA49.EmployeeSSN) and ADC.FILEID=EA49.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA49.WritingAgent='"+agent_code+"' and EA49.PayrollDeductionMode='"+pay_mode+"' and EA49.ApplicationState='"+location+"' and EA49.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA49.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA30 on  ADC.PRODUCTNUMBER=EA30.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA30.EmployeeSSN) and ADC.FILEID=EA30.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA30.WritingAgent='"+agent_code+"' and EA30.PayrollDeductionMode='"+pay_mode+"' and EA30.ApplicationState='"+location+"' and EA30.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA30.FileID in("+FileId+")";*/
		else if (description.contains("CHANG"))
		querytext="select ADC.GROUPNUMBER,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on  ADC.PRODUCTNUMBER=UFD.ProductNumber and  ADC.SSN=UFD.EmployeeSSN and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFD.WritingAgent='"+agent_code+"' and UFD.DeductionFrequency='"+pay_mode+"' and UFD.State='"+location+"' and UFD.ProductNumber='"+product+"' and UFD.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' and UFD.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on  ADC.PRODUCTNUMBER=UFN.ProductNumber and ADC.SSN=UFN.EmployeeSSN and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFN.WritingAgent='"+agent_code+"' and UFN.DeductionFrequency='"+pay_mode+"' and UFN.State='"+location+"' and UFN.ProductNumber='"+product+"' and UFN.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' and UFN.FileID in("+FileId+")";
/*
		querytext="select ADC.GROUPNUMBER,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on  ADC.PRODUCTNUMBER=UFD.ProductNumber and  dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(UFD.EmployeeSSN) and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFD.WritingAgent='"+agent_code+"' and UFD.DeductionFrequency='"+pay_mode+"' and UFD.State='"+location+"' and UFD.ProductNumber='"+product+"' and UFD.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' and UFD.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on  ADC.PRODUCTNUMBER=UFN.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(UFN.EmployeeSSN) and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFN.WritingAgent='"+agent_code+"' and UFN.DeductionFrequency='"+pay_mode+"' and UFN.State='"+location+"' and UFN.ProductNumber='"+product+"' and UFN.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' and UFN.FileID in("+FileId+")";
*/
		QueryObject query = new QueryObject(querytext);
		//BRELogger.error("ERROR_Count : "+querytext);	
		query.addParameter("grp_num", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, grp_num);
		/*query.addParameter("agent_code", "UF_DataValues.WritingAgent", QueryObject.PARAM_STRING, agent_code);
		query.addParameter("pay_mode", "UF_DataValues.DeductionFrequency", QueryObject.PARAM_STRING, pay_mode);
		query.addParameter("location", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, location);
		query.addParameter("product", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, product);
		query.addParameter("status", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, status); */
		query.setResultClass(ADL_DataAfterCompare.class);
		return query.getObjects();
       
    }
	 public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> GetDuplicateCountByFileID(String FileID)
    {
        String querytext="select count(*) as duplicateCount from ADL_DataAfterCompare where FILEID in ("+FileID+") and DESCRIPTION='DUPLICATE' ";
		QueryObject query = new QueryObject(querytext);
		query.addParameter("FileID", "ADL_DataAfterCompare.FILEID", QueryObject.PARAM_STRING, FileID);
		query.setResultClass(ADL_DataAfterCompare.class);
		return query.getObjects();
    }
	 public static int updateInterMedADLStatus(String OT_status, String InterMediateStatus)
	{

		DMLStatement dml = null;
                String queryText="update ADL_DataAfterCompare set OTStatus='"+InterMediateStatus+"' where OTStatus='"+OT_status+"'";
		
//BRELogger.error("ERROR_MESSAGE : "+queryText);		
dml = new DMLStatement(queryText);
//BRELogger.error("ERROR_MESSAGE : "+dml);	
		dml.execute();

		return (int)1;
	}
	public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getADLgroupDataforAEBOT(String GroupNumber)
    {
        BusObjectIterator <ADL_DataAfterCompare> resp1 = null;
		//String querytext="select GROUPNUMBER,MAX(MASTERAPPSFID) as MasterAppSF_ID,AgentCode,PAYMODE,STATE from ADL_DataAfterCompare where GROUPNUMBER='"+group_number+"' and Status='ToBeProcessed' group by AgentCode,GROUPNUMBER,PAYMODE,STATE";
		
		/*
		String querytext="select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFD.WritingAgent,UFD.DeductionFrequency,UFD.State,UFD.ProductNumber from ADL_DataAfterCompare ADC join UF_DataValues UFD on ADC.SSN=UFD.EmployeeSSN and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+group_number+"' and ADC.OTStatus='Processed' group by UFD.AgentCode,ADC.GROUPNUMBER,UFD.PAYMODE,UFD.STATE,UFD.ProductNumber";

		QueryObject query = new QueryObject(querytext);
		//logger.error("Method: ADL*********"+querytext);
		query.addParameter("GROUPNUMBER", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, group_number);
		query.setResultClass(ADL_DataAfterCompare.class);
		resp1=query.getObjects();

		if(resp1 == null ) 
				{
		 querytext="select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFN.WritingAgent,UFN.DeductionFrequency,UFN.State,UFN.ProductNumber,UFN.EmployeeSSN,UFN.FileID from ADL_DataAfterCompare ADC join UFN_DataValues UFN on ADC.SSN=UFN.EmployeeSSN and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+group_number+"' and ADC.OTStatus='ToBeProcessed' group by UFN.AgentCode,ADC.GROUPNUMBER,UFN.PAYMODE,UFN.STATE,UFN.ProductNumber,UFN.FileID";


		//logger.error("Method: ADL*********"+querytext);
		query.addParameter("GROUPNUMBER", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, group_number);
		query.setResultClass(ADL_DataAfterCompare.class);
		resp1=query.getObjects();
				}
		return resp1;
			}
		*//* column encryption and decryption change */
		String querytext="select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA53.WritingAgent, EA53.PayrollDeductionMode,EA53.ApplicationState, EA53.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA53.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA053DataValues EA53 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA53.EmployeeSSN) and ADC.FILEID=EA53.FileID and ADC.PRODUCTNUMBER=EA53.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA53.WritingAgent, EA53.PayrollDeductionMode, ADC.GROUPNUMBER,EA53.ApplicationState,EA53.productNumber,EA53.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA54.WritingAgent, EA54.PayrollDeductionMode,EA54.ApplicationState, EA54.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA54.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA054DataValues EA54 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA54.EmployeeSSN) and ADC.FILEID=EA54.FileID and ADC.PRODUCTNUMBER=EA54.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA54.WritingAgent, EA54.PayrollDeductionMode, ADC.GROUPNUMBER,EA54.ApplicationState,EA54.productNumber,EA54.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA55.WritingAgent, EA55.PayrollDeductionMode,EA55.ApplicationState, EA55.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA55.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA055DataValues EA55 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA55.EmployeeSSN) and ADC.FILEID=EA55.FileID and ADC.PRODUCTNUMBER=EA55.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA55.WritingAgent, EA55.PayrollDeductionMode, ADC.GROUPNUMBER,EA55.ApplicationState,EA55.productNumber,EA55.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA56.WritingAgent, EA56.PayrollDeductionMode,EA56.ApplicationState, EA56.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA56.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA056DataValues EA56 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA56.EmployeeSSN) and ADC.FILEID=EA56.FileID and ADC.PRODUCTNUMBER=EA56.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA56.WritingAgent, EA56.PayrollDeductionMode, ADC.GROUPNUMBER,EA56.ApplicationState,EA56.productNumber,EA56.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA52.WritingAgent, EA52.PayrollDeductionMode, EA52.ApplicationState, Ea52.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA52.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA052DataValues EA52 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA52.EmployeeSSN) and ADC.FILEID=EA52.FileID and ADC.PRODUCTNUMBER=EA52.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA52.WritingAgent, EA52.PayrollDeductionMode, ADC.GROUPNUMBER,EA52.ApplicationState, Ea52.productNumber,EA52.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA51.WritingAgent, EA51.PayrollDeductionMode, EA51.ApplicationState, Ea51.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA51.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA051DataValues EA51 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA51.EmployeeSSN) and ADC.FILEID=EA51.FileID and ADC.PRODUCTNUMBER=EA51.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA51.WritingAgent, EA51.PayrollDeductionMode, ADC.GROUPNUMBER,EA51.ApplicationState, EA51.productNumber,EA51.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA50.WritingAgent, EA50.PayrollDeductionMode, EA50.ApplicationState, EA50.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA50.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA050DataValues EA50 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA50.EmployeeSSN) and ADC.FILEID=EA50.FileID and ADC.PRODUCTNUMBER=EA50.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA50.WritingAgent, EA50.PayrollDeductionMode, ADC.GROUPNUMBER,EA50.ApplicationState, EA50.productNumber,EA50.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA42.WritingAgent, EA42.PayrollDeductionMode, EA42.ApplicationState, EA42.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA42.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA042DataValues EA42 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA42.EmployeeSSN) and ADC.FILEID=EA42.FileID and ADC.PRODUCTNUMBER=EA42.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA42.WritingAgent, EA42.PayrollDeductionMode, ADC.GROUPNUMBER,EA42.ApplicationState, EA42.productNumber,EA42.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA49.WritingAgent, EA49.PayrollDeductionMode, EA49.ApplicationState, EA49.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA49.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA049DataValues EA49 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA49.EmployeeSSN) and ADC.FILEID=EA49.FileID and ADC.PRODUCTNUMBER=EA49.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA49.WritingAgent, EA49.PayrollDeductionMode, ADC.GROUPNUMBER,EA49.ApplicationState, EA49.productNumber,EA49.PolicyEffectiveDate Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA30.WritingAgent, EA30.PayrollDeductionMode, EA30.ApplicationState, EA30.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION,EA30.PolicyEffectiveDate from ADL_DataAfterCompare ADC join EA030DataValues EA30 on CONVERT(Int,ADC.SSN)=CONVERT(INT,EA30.EmployeeSSN) and ADC.FILEID=EA30.FileID and ADC.PRODUCTNUMBER=EA30.ProductNumber where ADC.FILEID in ("+GroupNumber+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA30.WritingAgent, EA30.PayrollDeductionMode, ADC.GROUPNUMBER,EA30.ApplicationState, EA30.productNumber,EA30.PolicyEffectiveDate";

		/* column encryption and decryption change */
	/*	String querytext="select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFD.WritingAgent,UFD.DeductionFrequency,UFD.State,UFD.ProductNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(UFD.EmployeeSSN)) and ADC.FILEID=UFD.FileID and ADC.PRODUCTNUMBER=UFD.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and UFD.RecordType='1' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by UFD.WritingAgent,UFD.DeductionFrequency,ADC.GROUPNUMBER,UFD.STATE,UFD.ProductNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,UFN.WritingAgent,UFN.DeductionFrequency as DeductionFrequency,UFN.State,UFN.ProductNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(UFN.EmployeeSSN)) and ADC.FILEID=UFN.FileID and ADC.PRODUCTNUMBER=UFN.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and UFN.RecordType='1' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by UFN.WritingAgent,UFN.DeductionFrequency,ADC.GROUPNUMBER,UFN.STATE,UFN.ProductNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA53.WritingAgent, EA53.PayrollDeductionMode,EA53.ApplicationState, EA53.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA53 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA53.EmployeeSSN)) and ADC.FILEID=EA53.FileID and ADC.PRODUCTNUMBER=EA53.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA53.WritingAgent, EA53.PayrollDeductionMode, ADC.GROUPNUMBER,EA53.ApplicationState,EA53.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA54.WritingAgent, EA54.PayrollDeductionMode,EA54.ApplicationState, EA54.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA54 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA54.EmployeeSSN)) and ADC.FILEID=EA54.FileID and ADC.PRODUCTNUMBER=EA54.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA54.WritingAgent, EA54.PayrollDeductionMode, ADC.GROUPNUMBER,EA54.ApplicationState,EA54.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA55.WritingAgent, EA55.PayrollDeductionMode,EA55.ApplicationState, EA55.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA55 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA55.EmployeeSSN)) and ADC.FILEID=EA55.FileID and ADC.PRODUCTNUMBER=EA55.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA55.WritingAgent, EA55.PayrollDeductionMode, ADC.GROUPNUMBER,EA55.ApplicationState,EA55.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA56.WritingAgent, EA56.PayrollDeductionMode,EA56.ApplicationState, EA56.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA56 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA56.EmployeeSSN)) and ADC.FILEID=EA56.FileID and ADC.PRODUCTNUMBER=EA56.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA56.WritingAgent, EA56.PayrollDeductionMode, ADC.GROUPNUMBER,EA56.ApplicationState,EA56.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA52.WritingAgent, EA52.PayrollDeductionMode, EA52.ApplicationState, Ea52.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA52 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA52.EmployeeSSN)) and ADC.FILEID=EA52.FileID and ADC.PRODUCTNUMBER=EA52.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA52.WritingAgent, EA52.PayrollDeductionMode, ADC.GROUPNUMBER,EA52.ApplicationState, Ea52.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA51.WritingAgent, EA51.PayrollDeductionMode, EA51.ApplicationState, Ea51.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA51 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA51.EmployeeSSN)) and ADC.FILEID=EA51.FileID and ADC.PRODUCTNUMBER=EA51.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA51.WritingAgent, EA51.PayrollDeductionMode, ADC.GROUPNUMBER,EA51.ApplicationState, EA51.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA50.WritingAgent, EA50.PayrollDeductionMode, EA50.ApplicationState, EA50.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA50 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA50.EmployeeSSN)) and ADC.FILEID=EA50.FileID and ADC.PRODUCTNUMBER=EA50.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA50.WritingAgent, EA50.PayrollDeductionMode, ADC.GROUPNUMBER,EA50.ApplicationState, EA50.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA42.WritingAgent, EA42.PayrollDeductionMode, EA42.ApplicationState, EA42.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA42 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA42.EmployeeSSN)) and ADC.FILEID=EA42.FileID and ADC.PRODUCTNUMBER=EA42.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA42.WritingAgent, EA42.PayrollDeductionMode, ADC.GROUPNUMBER,EA42.ApplicationState, EA42.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA49.WritingAgent, EA49.PayrollDeductionMode, EA49.ApplicationState, EA49.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA49 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA49.EmployeeSSN)) and ADC.FILEID=EA49.FileID and ADC.PRODUCTNUMBER=EA49.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA49.WritingAgent, EA49.PayrollDeductionMode, ADC.GROUPNUMBER,EA49.ApplicationState, EA49.productNumber Union select ADC.GROUPNUMBER,MAX(ADC.MASTERAPPSFID) as MasterAppSF_ID,EA30.WritingAgent, EA30.PayrollDeductionMode, EA30.ApplicationState, EA30.productNumber,MAX(ADC.DESCRIPTION) as DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA30 on CONVERT(Int,dbo.fn_fpDecryptData(ADC.SSN))=CONVERT(INT,dbo.fn_fpDecryptData(EA30.EmployeeSSN)) and ADC.FILEID=EA30.FileID and ADC.PRODUCTNUMBER=EA30.ProductNumber where ADC.FILEID in ("+group_number+") and ADC.OTStatus='Processed' and ADC.DESCRIPTION='NEW/INDIVIDUAL' group by EA30.WritingAgent, EA30.PayrollDeductionMode, ADC.GROUPNUMBER,EA30.ApplicationState, EA30.productNumber"; */
		QueryObject query = new QueryObject(querytext);
		//BRELogger.error("ERROR_MESSAGE : "+querytext);	
		query.addParameter("GROUPNUMBER", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, GroupNumber);
		query.setResultClass(ADL_DataAfterCompare.class);
		return query.getObjects();
    }
	
	public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> getFPtaskLevelCountforAEBOTNew(String grp_num, String agent_code, String pay_mode, String location, String product, String status, String description, String FileId, String EffectiveDate)
    {
        String querytext="";
		if(description.equals("NEW/INDIVIDUAL") || description.equals("TERMINATED") || description.equals("REINST") || description.equals("REINSTATEMENT"))
		querytext="select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA53 on  ADC.PRODUCTNUMBER=EA53.ProductNumber and ADC.SSN=EA53.EmployeeSSN and ADC.FILEID=EA53.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA53.WritingAgent='"+agent_code+"' and EA53.PayrollDeductionMode='"+pay_mode+"' and EA53.ApplicationState='"+location+"' and EA53.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA53.FileID in("+FileId+") and EA53.PolicyEffectiveDate in("+EffectiveDate+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA54 on  ADC.PRODUCTNUMBER=EA54.ProductNumber and ADC.SSN=EA54.EmployeeSSN and ADC.FILEID=EA54.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA54.WritingAgent='"+agent_code+"' and EA54.PayrollDeductionMode='"+pay_mode+"' and EA54.ApplicationState='"+location+"' and EA54.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA54.FileID in("+FileId+") and EA54.PolicyEffectiveDate in("+EffectiveDate+")Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA55 on  ADC.PRODUCTNUMBER=EA55.ProductNumber and ADC.SSN=EA55.EmployeeSSN and ADC.FILEID=EA55.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA55.WritingAgent='"+agent_code+"' and EA55.PayrollDeductionMode='"+pay_mode+"' and EA55.ApplicationState='"+location+"' and EA55.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA55.FileID in("+FileId+") and EA55.PolicyEffectiveDate in("+EffectiveDate+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA56 on  ADC.PRODUCTNUMBER=EA56.ProductNumber and ADC.SSN=EA56.EmployeeSSN and ADC.FILEID=EA56.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA56.WritingAgent='"+agent_code+"' and EA56.PayrollDeductionMode='"+pay_mode+"' and EA56.ApplicationState='"+location+"' and EA56.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA56.FileID in("+FileId+") and EA56.PolicyEffectiveDate in("+EffectiveDate+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA52 on  ADC.PRODUCTNUMBER=EA52.ProductNumber and ADC.SSN=EA52.EmployeeSSN and ADC.FILEID=EA52.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA52.WritingAgent='"+agent_code+"' and EA52.PayrollDeductionMode='"+pay_mode+"' and EA52.ApplicationState='"+location+"' and EA52.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA52.FileID in("+FileId+") and EA52.PolicyEffectiveDate in("+EffectiveDate+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA51 on  ADC.PRODUCTNUMBER=EA51.ProductNumber and ADC.SSN=EA51.EmployeeSSN and ADC.FILEID=EA51.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA51.WritingAgent='"+agent_code+"' and EA51.PayrollDeductionMode='"+pay_mode+"' and EA51.ApplicationState='"+location+"' and EA51.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA51.FileID in("+FileId+") and EA51.PolicyEffectiveDate in("+EffectiveDate+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA50 on  ADC.PRODUCTNUMBER=EA50.ProductNumber and ADC.SSN=EA50.EmployeeSSN and ADC.FILEID=EA50.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA50.WritingAgent='"+agent_code+"' and EA50.PayrollDeductionMode='"+pay_mode+"' and EA50.ApplicationState='"+location+"' and EA50.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA50.FileID in("+FileId+") and EA50.PolicyEffectiveDate in("+EffectiveDate+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA42 on  ADC.PRODUCTNUMBER=EA42.ProductNumber and ADC.SSN=EA42.EmployeeSSN and ADC.FILEID=EA42.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA42.WritingAgent='"+agent_code+"' and EA42.PayrollDeductionMode='"+pay_mode+"' and EA42.ApplicationState='"+location+"' and EA42.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA42.FileID in("+FileId+") and EA42.PolicyEffectiveDate in("+EffectiveDate+")  Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA49 on  ADC.PRODUCTNUMBER=EA49.ProductNumber and ADC.SSN=EA49.EmployeeSSN and ADC.FILEID=EA49.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA49.WritingAgent='"+agent_code+"' and EA49.PayrollDeductionMode='"+pay_mode+"' and EA49.ApplicationState='"+location+"' and EA49.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA49.FileID in("+FileId+") and EA49.PolicyEffectiveDate in("+EffectiveDate+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA30 on  ADC.PRODUCTNUMBER=EA30.ProductNumber and ADC.SSN=EA30.EmployeeSSN and ADC.FILEID=EA30.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA30.WritingAgent='"+agent_code+"' and EA30.PayrollDeductionMode='"+pay_mode+"' and EA30.ApplicationState='"+location+"' and EA30.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA30.FileID in("+FileId+") and EA30.PolicyEffectiveDate in("+EffectiveDate+") "; 
/* column encryption and decryption change */
/*
		querytext="select ADC.GROUPNUMBER,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on  ADC.PRODUCTNUMBER=UFD.ProductNumber and  dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(UFD.EmployeeSSN) and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFD.WritingAgent='"+agent_code+"' and UFD.DeductionFrequency='"+pay_mode+"' and UFD.State='"+location+"' and UFD.ProductNumber='"+product+"' and UFD.RecordType='1' and ADC.DESCRIPTION = '"+description+"' and UFD.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on  ADC.PRODUCTNUMBER=UFN.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(UFN.EmployeeSSN) and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFN.WritingAgent='"+agent_code+"' and UFN.DeductionFrequency='"+pay_mode+"' and UFN.State='"+location+"' and UFN.ProductNumber='"+product+"' and UFN.RecordType='1'  and ADC.DESCRIPTION = '"+description+"' and UFN.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA053DataValues EA53 on  ADC.PRODUCTNUMBER=EA53.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA53.EmployeeSSN) and ADC.FILEID=EA53.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA53.WritingAgent='"+agent_code+"' and EA53.PayrollDeductionMode='"+pay_mode+"' and EA53.ApplicationState='"+location+"' and EA53.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA53.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA054DataValues EA54 on  ADC.PRODUCTNUMBER=EA54.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA54.EmployeeSSN) and ADC.FILEID=EA54.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA54.WritingAgent='"+agent_code+"' and EA54.PayrollDeductionMode='"+pay_mode+"' and EA54.ApplicationState='"+location+"' and EA54.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA54.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA055DataValues EA55 on  ADC.PRODUCTNUMBER=EA55.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA55.EmployeeSSN) and ADC.FILEID=EA55.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA55.WritingAgent='"+agent_code+"' and EA55.PayrollDeductionMode='"+pay_mode+"' and EA55.ApplicationState='"+location+"' and EA55.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA55.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA056DataValues EA56 on  ADC.PRODUCTNUMBER=EA56.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA56.EmployeeSSN) and ADC.FILEID=EA56.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA56.WritingAgent='"+agent_code+"' and EA56.PayrollDeductionMode='"+pay_mode+"' and EA56.ApplicationState='"+location+"' and EA56.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA56.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA052DataValues EA52 on  ADC.PRODUCTNUMBER=EA52.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA52.EmployeeSSN) and ADC.FILEID=EA52.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA52.WritingAgent='"+agent_code+"' and EA52.PayrollDeductionMode='"+pay_mode+"' and EA52.ApplicationState='"+location+"' and EA52.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA52.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA051DataValues EA51 on  ADC.PRODUCTNUMBER=EA51.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA51.EmployeeSSN) and ADC.FILEID=EA51.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA51.WritingAgent='"+agent_code+"' and EA51.PayrollDeductionMode='"+pay_mode+"' and EA51.ApplicationState='"+location+"' and EA51.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA51.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA050DataValues EA50 on  ADC.PRODUCTNUMBER=EA50.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA50.EmployeeSSN) and ADC.FILEID=EA50.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA50.WritingAgent='"+agent_code+"' and EA50.PayrollDeductionMode='"+pay_mode+"' and EA50.ApplicationState='"+location+"' and EA50.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA50.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA042DataValues EA42 on  ADC.PRODUCTNUMBER=EA42.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA42.EmployeeSSN) and ADC.FILEID=EA42.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA42.WritingAgent='"+agent_code+"' and EA42.PayrollDeductionMode='"+pay_mode+"' and EA42.ApplicationState='"+location+"' and EA42.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA42.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA049DataValues EA49 on  ADC.PRODUCTNUMBER=EA49.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA49.EmployeeSSN) and ADC.FILEID=EA49.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA49.WritingAgent='"+agent_code+"' and EA49.PayrollDeductionMode='"+pay_mode+"' and EA49.ApplicationState='"+location+"' and EA49.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA49.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join EA030DataValues EA30 on  ADC.PRODUCTNUMBER=EA30.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(EA30.EmployeeSSN) and ADC.FILEID=EA30.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and EA30.WritingAgent='"+agent_code+"' and EA30.PayrollDeductionMode='"+pay_mode+"' and EA30.ApplicationState='"+location+"' and EA30.ProductNumber='"+product+"' and ADC.DESCRIPTION = '"+description+"' and EA30.FileID in("+FileId+")";*/
		else if (description.contains("CHANG"))
		querytext="select ADC.GROUPNUMBER,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on  ADC.PRODUCTNUMBER=UFD.ProductNumber and  ADC.SSN=UFD.EmployeeSSN and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFD.WritingAgent='"+agent_code+"' and UFD.DeductionFrequency='"+pay_mode+"' and UFD.State='"+location+"' and UFD.ProductNumber='"+product+"' and UFD.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' and UFD.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on  ADC.PRODUCTNUMBER=UFN.ProductNumber and ADC.SSN=UFN.EmployeeSSN and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFN.WritingAgent='"+agent_code+"' and UFN.DeductionFrequency='"+pay_mode+"' and UFN.State='"+location+"' and UFN.ProductNumber='"+product+"' and UFN.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' and UFN.FileID in("+FileId+")";
/*
		querytext="select ADC.GROUPNUMBER,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UF_DataValues UFD on  ADC.PRODUCTNUMBER=UFD.ProductNumber and  dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(UFD.EmployeeSSN) and ADC.FILEID=UFD.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFD.WritingAgent='"+agent_code+"' and UFD.DeductionFrequency='"+pay_mode+"' and UFD.State='"+location+"' and UFD.ProductNumber='"+product+"' and UFD.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' and UFD.FileID in("+FileId+") Union All select ADC.GROUPNUMBER ,ADC.DESCRIPTION from ADL_DataAfterCompare ADC join UFN_DataValues UFN on  ADC.PRODUCTNUMBER=UFN.ProductNumber and dbo.fn_fpDecryptData(ADC.SSN)=dbo.fn_fpDecryptData(UFN.EmployeeSSN) and ADC.FILEID=UFN.FileID where ADC.GROUPNUMBER='"+grp_num+"' and ADC.OTStatus='"+status+"' and UFN.WritingAgent='"+agent_code+"' and UFN.DeductionFrequency='"+pay_mode+"' and UFN.State='"+location+"' and UFN.ProductNumber='"+product+"' and UFN.RecordType='1' and ADC.DESCRIPTION like '"+description+"%' and UFN.FileID in("+FileId+")";
*/
		QueryObject query = new QueryObject(querytext);
		//BRELogger.error("ERROR_Count : "+querytext);	
		query.addParameter("grp_num", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, grp_num);
		/*query.addParameter("agent_code", "UF_DataValues.WritingAgent", QueryObject.PARAM_STRING, agent_code);
		query.addParameter("pay_mode", "UF_DataValues.DeductionFrequency", QueryObject.PARAM_STRING, pay_mode);
		query.addParameter("location", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, location);
		query.addParameter("product", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, product);
		query.addParameter("status", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, status); */
		query.setResultClass(ADL_DataAfterCompare.class);
		return query.getObjects();
    }
	
	public static BusObjectIterator<com.worksitewsapppackage.ADL_DataAfterCompare> FetchGroupNameforAEBOT(String GroupNumber, String FileID)
    {
        
      String querytext="select  distinct GROUPNAME from ADL_DataAfterCompare where FILEID='"+FileID+"'and GROUPNUMBER='"+GroupNumber+"' and GROUPNAME <>''";
       QueryObject query = new QueryObject(querytext);
        query. addParameter("GROUPNUMBER", "ADL_DataAfterCompare.GROUPNUMBER", QueryObject.PARAM_STRING, GroupNumber);
		query. addParameter("FILEID", "ADL_DataAfterCompare.FILEID", QueryObject.PARAM_STRING, FileID);//NOPMD
        query.setResultClass(ADL_DataAfterCompare.class);
		return query.getObjects();
    }


}