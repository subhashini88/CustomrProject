/*
  This class has been generated by the Code Generator
*/

package com.worksitewsapppackage;


import com.cordys.cpc.bsf.busobject.BusObjectConfig;
import com.cordys.cpc.bsf.busobject.BusObjectIterator;
import com.cordys.cpc.bsf.busobject.DMLStatement;
import com.cordys.cpc.bsf.busobject.QueryObject;
import com.eibus.util.logger.CordysLogger;

import java.text.SimpleDateFormat;
import java.util.Date;


public class SFDataRequest extends SFDataRequestBase
{
	public static CordysLogger logger=CordysLogger.getCordysLogger(SFDataRequest.class);
    public SFDataRequest()
    {
        this((BusObjectConfig)null);
    }

    public SFDataRequest(BusObjectConfig config)
    {
        super(config);
    }
/*
    public static String updateDataSF(String Header, String JSONOutput, String CompanyCode, String GroupNumber, String MasterAppNumber)
    {
        String queryText=""; String dbquery="";

        //SimpleDateFormat formatter = new SimpleDateFormat("dd/MM/yyyy HH:mm:ss");
	//Date date = new Date();
       //currDateTime = formatter.format(date);

	  String query1 = "SELECT * FROM SFDataRequest WHERE CompanyCode= :CompanyCode and GroupNumber= :GroupNumber and MasterAppNumber= :MasterAppNumber and Tab = :Header";
            QueryObject queryObj1 = new QueryObject(query1);
			queryObj1.addParameter("CompanyCode", "SFDataRequest.CompanyCode", QueryObject.PARAM_STRING, CompanyCode);
			queryObj1.addParameter("GroupNumber", "SFDataRequest.GroupNumber", QueryObject.PARAM_STRING, GroupNumber);
			queryObj1.addParameter("MasterAppNumber", "SFDataRequest.MasterAppNumber", QueryObject.PARAM_STRING, MasterAppNumber);
                        queryObj1.addParameter("Header", "SFDataRequest.Tab", QueryObject.PARAM_STRING, Header);  
			queryObj1.setResultClass(SFDataRequest.class);
            BusObjectIterator<SFDataRequest> WimsData = queryObj1.getObjects();       
            if(WimsData.hasMoreElements()){
				
				//queryText ="UPDATE  SFDataRequest set SFData = '"+JSONOutput+"' where Tab ='"+Header+"' and CompanyCode= '"+CompanyCode+"' and GroupNumber= '"+GroupNumber+"' and MasterAppNumber= '"+MasterAppNumber+"' and LastUpdateDateTime = '"+date+"'";
queryText ="UPDATE  SFDataRequest set SFData = '"+JSONOutput+"' where Tab ='"+Header+"' and CompanyCode= '"+CompanyCode+"' and GroupNumber= '"+GroupNumber+"' and MasterAppNumber= '"+MasterAppNumber+"'";
				dbquery="updated";
			}
	  else
         {
	  //queryText ="INSERT INTO SFDataRequest(Tab,CompanyCode,GroupNumber,MasterAppNumber,SFData,CreatedDateTime)  "
	  		//+ "VALUES('"+Header+"','"+CompanyCode+"','"+GroupNumber+"','"+MasterAppNumber+"','"+JSONOutput+"','"+date+"')";
queryText ="INSERT INTO SFDataRequest(Tab,CompanyCode,GroupNumber,MasterAppNumber,SFData)  "
	  		+ "VALUES('"+Header+"','"+CompanyCode+"','"+GroupNumber+"','"+MasterAppNumber+"','"+JSONOutput+"')";
          dbquery="inserted";
  	 }
  	try
  	{
  	DMLStatement updateData1 = new DMLStatement(queryText);
  	updateData1.execute();
  	}
  	catch(Exception E)
  	{
  		return "failed";
  	}
  	return dbquery;
    }
*/
    public static String updateDataSF(String Header, String JSONOutput, String CompanyCode, String GroupNumber, String MasterAppNumber)
    {
        String queryText=""; String dbquery="";



        try
        {
        	String query1 = "SELECT * FROM SFDataRequest WHERE CompanyCode= :CompanyCode and GroupNumber= :GroupNumber and MasterAppNumber= :MasterAppNumber and Tab = :Header";
            QueryObject queryObj1 = new QueryObject(query1);
			queryObj1.addParameter("CompanyCode", "SFDataRequest.CompanyCode", QueryObject.PARAM_STRING, CompanyCode);
			queryObj1.addParameter("GroupNumber", "SFDataRequest.GroupNumber", QueryObject.PARAM_STRING, GroupNumber);
			queryObj1.addParameter("MasterAppNumber", "SFDataRequest.MasterAppNumber", QueryObject.PARAM_STRING, MasterAppNumber);
                        queryObj1.addParameter("Header", "SFDataRequest.Tab", QueryObject.PARAM_STRING, Header);  
			queryObj1.setResultClass(SFDataRequest.class);
            BusObjectIterator<SFDataRequest> WimsData = queryObj1.getObjects();      
    
            if(WimsData.hasMoreElements())
            {
            	SFDataRequest sfDataObj=WimsData.nextElement();
            	if(sfDataObj!=null)
            	{
            		sfDataObj.setSFData(JSONOutput);
            		sfDataObj.update();
            		dbquery="updated";
            	}
            }
            else
            {
            	SFDataRequest sfDataObj=new SFDataRequest();
            	sfDataObj.setTab(Header);
            	sfDataObj.setCompanyCode(CompanyCode);
            	sfDataObj.setGroupNumber(GroupNumber);
            	sfDataObj.setMasterAppNumber(MasterAppNumber);
            	sfDataObj.setSFData(JSONOutput);
            	sfDataObj.insert();
            	dbquery="inserted";
            }
        }catch(Exception e)
        {
        	dbquery="failed";
        	logger.error("Error in updateDataSF method, Error:"+e);
        }
	  
  	return dbquery;
    }

}
