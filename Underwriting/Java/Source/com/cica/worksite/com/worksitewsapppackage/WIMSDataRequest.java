/*
  This class has been generated by the Code Generator
*/

package com.worksitewsapppackage;

import com.cordys.cpc.bsf.busobject.BusObjectConfig;
import com.cordys.cpc.bsf.busobject.BusObjectIterator;
import com.cordys.cpc.bsf.busobject.DMLStatement;
import com.cordys.cpc.bsf.busobject.QueryObject;
import java.util.*;
import com.cordys.cpc.bsf.busobject.BSF;
import com.eibus.util.logger.CordysLogger;


public class WIMSDataRequest extends WIMSDataRequestBase
{
	public static CordysLogger logger=CordysLogger.getCordysLogger(WIMSDataRequest.class);
    public WIMSDataRequest()
    {
        this((BusObjectConfig)null);
    }

    public WIMSDataRequest(BusObjectConfig config)
    {
        super(config);
    }

  public static BusObjectIterator<com.worksitewsapppackage.WIMSDataRequest> getWIMSdata()
    {
        String queryText = "select * from WIMSDataRequest";
        QueryObject query = new QueryObject(queryText);
        query.setResultClass(WIMSDataRequest.class);
        return query.getObjects();
    }
/*
  public static String updateData(String Header,String JSONOutput,String CompanyCode,String GroupNumber,String MasterAppNumber,String ScreenName,String programName)
  {
  	String queryText="";
	  String query1 = "SELECT * FROM WIMSDataRequest WHERE CompanyCode= :CompanyCode and GroupNumber= :GroupNumber and MasterAppNumber= :MasterAppNumber and header = :Header";
            QueryObject queryObj1 = new QueryObject(query1);
			queryObj1.addParameter("CompanyCode", "WIMSDataRequest.CompanyCode", QueryObject.PARAM_STRING, CompanyCode);
			queryObj1.addParameter("GroupNumber", "WIMSDataRequest.GroupNumber", QueryObject.PARAM_STRING, GroupNumber);
			queryObj1.addParameter("MasterAppNumber", "WIMSDataRequest.MasterAppNumber", QueryObject.PARAM_STRING, MasterAppNumber);
                        queryObj1.addParameter("Header", "WIMSDataRequest.header", QueryObject.PARAM_STRING, Header);  
			queryObj1.setResultClass(WIMSDataRequest.class);
            BusObjectIterator<WIMSDataRequest> WimsData = queryObj1.getObjects();       
            if(WimsData.hasMoreElements()){
				
				queryText ="UPDATE  WimsdataRequest set CurrentScreenData = '"+JSONOutput+"',ProgramName = '"+programName+"' where header ='"+Header+"' and CompanyCode= '"+CompanyCode+"' and GroupNumber= '"+GroupNumber+"' and MasterAppNumber= '"+MasterAppNumber+"'";
				
			}
	  else
	  queryText ="INSERT INTO WIMSDataRequest(ScreenName,header,CompanyCode,GroupNumber,MasterAppNumber,CurrentScreenData,ProgramName)  "
	  		+ "VALUES('"+ScreenName+"','"+Header+"','"+CompanyCode+"','"+GroupNumber+"','"+MasterAppNumber+"','"+JSONOutput+"','"+programName+"')";
  	 
  	try
  	{
  	DMLStatement updateData1 = new DMLStatement(queryText);
  	updateData1.execute();
  	}
  	catch(Exception E)
  	{
  		return "failed";
  	}
  	return "updated";

}
*/
  public static String updateData(String Header,String JSONOutput,String CompanyCode,String GroupNumber,String MasterAppNumber,String ScreenName,String programName)
  {
  	String queryText="";
	  String query1 = "SELECT * FROM WIMSDataRequest WHERE CompanyCode= :CompanyCode and GroupNumber= :GroupNumber and MasterAppNumber= :MasterAppNumber and header = :Header";
	 try
	 {
		QueryObject queryObj1 = new QueryObject(query1);
		queryObj1.addParameter("CompanyCode", "WIMSDataRequest.CompanyCode", QueryObject.PARAM_STRING, CompanyCode);
		queryObj1.addParameter("GroupNumber", "WIMSDataRequest.GroupNumber", QueryObject.PARAM_STRING, GroupNumber);
		queryObj1.addParameter("MasterAppNumber", "WIMSDataRequest.MasterAppNumber", QueryObject.PARAM_STRING, MasterAppNumber);
        queryObj1.addParameter("Header", "WIMSDataRequest.header", QueryObject.PARAM_STRING, Header);  
		queryObj1.setResultClass(WIMSDataRequest.class);
        BusObjectIterator<WIMSDataRequest> WimsData = queryObj1.getObjects();       
        if(WimsData.hasMoreElements()){
        	
        	WIMSDataRequest wimsDataObj=WimsData.nextElement();
			wimsDataObj.setCurrentScreenData(JSONOutput);
			wimsDataObj.setProgramName(programName);
			wimsDataObj.update();
		}else
		{
			//(ScreenName,header,CompanyCode,GroupNumber,MasterAppNumber,CurrentScreenData,ProgramName) 
			WIMSDataRequest objData=new WIMSDataRequest();
			objData.setScreenName(ScreenName);
			objData.setHeader(Header);
			objData.setCompanyCode(CompanyCode);
			objData.setGroupNumber(GroupNumber);
			objData.setMasterAppNumber(MasterAppNumber);
			objData.setCurrentScreenData(JSONOutput);
			objData.setProgramName(programName);
			objData.insert();
		}
        return "updated";
	 }catch(Exception e)
	 {
		 logger.error("Error in UpdateData method:"+e);
		 return "failed";
	 }
}
 public static String UpdateAttemptID(String Header,String CompanyCode,String GroupNumber,String MasterAppNumber,String AttemptNumber,String EmptyHeaders)
  {

	 String queryText = "";
boolean obj1 = EmptyHeaders.contains("'");
if(obj1)
{
  queryText ="UPDATE  WimsdataRequest set AttemptNumber= '"+AttemptNumber+"' where  CompanyCode= '"+CompanyCode+"' and GroupNumber= '"+GroupNumber+"' and MasterAppNumber= '"+MasterAppNumber+"' and header not in ("+EmptyHeaders+") ";
}
else{
	
	  queryText ="UPDATE  WimsdataRequest set AttemptNumber= '"+AttemptNumber+"' where  CompanyCode= '"+CompanyCode+"' and GroupNumber= '"+GroupNumber+"' and MasterAppNumber= '"+MasterAppNumber+"' ";


}	
  	try
  	{
  	DMLStatement updateData1 = new DMLStatement(queryText);
  	updateData1.execute();
  	}
  	catch(Exception E)
  	{
  		return queryText;
  	}
  	return "updated";
  }
protected void onBeforeInsert()
{
String userDN = BSF.getUser();
this.setCreatedOn(new Date(new Date().getTime() - (new Date().getTimezoneOffset() * 60 * 1000)));
this.setCreatedBy(userDN.substring(3,userDN.indexOf(",")));
}
protected void onBeforeUpdate()
{
String userDN = BSF.getUser();
this.setUpdatedOn(new Date(new Date().getTime() - (new Date().getTimezoneOffset() * 60 * 1000)));
this.setUpdatedBy(userDN.substring(3,userDN.indexOf(",")));
}
}