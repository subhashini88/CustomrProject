/*
  This class has been generated by the Code Generator
*/

package com.worksitewsapppackage;

import com.cordys.cpc.bsf.busobject.BusObjectConfig;
import com.cordys.cpc.bsf.busobject.BusObjectIterator;
import com.cordys.cpc.bsf.busobject.QueryObject;

public class ADL_InputFiles extends ADL_InputFilesBase
{
    public ADL_InputFiles()
    {
        this((BusObjectConfig)null);
    }

    public ADL_InputFiles(BusObjectConfig config)
    {
        super(config);
    }
public static BusObjectIterator<com.worksitewsapppackage.ADL_InputFiles> getAllADLErrorFiles()
    {
        
//String queryText = "select FileID,FileName,SalesForceContactName,status,ErrorMessage,FileProcessDate,FileReceviedDate,count,ServerPath from ADL_InputFiles where Status like'%Preprocessing%'";
String queryText = "select FileID,FileName,SalesForceContactName,status,ErrorMessage,FileProcessDate,FileReceviedDate,count,ServerPath from ADL_InputFiles where FileID not in (select a.FileID from (select * from ADL_InputFiles  where status like'%Preprocessing%') a join WKSEnrollmentTask WT on cast(a.FileID as varchar) =WT.FileId where WT.Status='Task Active') and status like'%Preprocessing%'";
        QueryObject query = new QueryObject(queryText);
        query.setResultClass(ADL_InputFiles.class);
        return query.getObjects();
    }
    public static BusObjectIterator<com.worksitewsapppackage.ADL_InputFiles> getADLFilesUsingFileID(String file_id)
    {
        String queryText = "select * from ADL_InputFiles where FileID in ("+file_id+")";
        QueryObject query = new QueryObject(queryText);
        query.setResultClass(ADL_InputFiles.class);
        return query.getObjects();
    }
    public static BusObjectIterator<com.worksitewsapppackage.ADL_InputFiles> GetFilesProcessedNE(String Date,String Run)
    {
String FDate=Date+" 00:00AM";
String TDate=Date+" 23:58PM";
        String queryText = "SELECT( select count(*) as 'Files Processed' from ADL_InputFiles where FileReceviedDate > '"+FDate+"' and FileReceviedDate < '"+TDate+"' and Run= '"+Run+"')+( select count(*) as 'Files Processed' from ADL_InputFiles_EmptyFiles where FileReceviedDate >  '"+FDate+"' and FileReceviedDate < '"+TDate+"' and Run= '"+Run+"') AS FilesProcessedCount,max(FileReceviedDate) as LatestDate from ADL_InputFiles where FileReceviedDate > '"+FDate+"' and FileReceviedDate < '"+TDate+"' and Run= '"+Run+"' ";
        QueryObject query = new QueryObject(queryText);
        query.setResultClass(ADL_InputFiles.class);
        return query.getObjects();
    }
  public static BusObjectIterator<com.worksitewsapppackage.ADL_InputFiles> GetFilesProcessedE(String Date)
    {
String FDate=Date+" 00:00AM";
String TDate=Date+" 23:58PM";
        String queryText = "select sum(NewFilesCount) as 'FilesDownloaded',Run from TumbleWeed_Files where FileReceviedDate > '"+FDate+"' and FileReceviedDate < '"+TDate+"' group by Run";
        QueryObject query = new QueryObject(queryText);
        query.setResultClass(ADL_InputFiles.class);
        return query.getObjects();
    }

}
